<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport"content="user-scalable=no"/><meta name="viewport"content="initial-scale=1.0"><meta name="viewport"content="width=320.1"><meta name="viewport"content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1"><meta name="apple-mobile-web-app-capable"content="yes"/><link rel="apple-touch-icon-precomposed"href="img/touch-icon-iphone-retina.png"/><link rel="apple-touch-icon-precomposed"sizes="72x72"href="img/touch-icon-ipad.png"/><link rel="apple-touch-icon-precomposed"sizes="114x114"href="img/touch-icon-iphone-retina.png"/><title>Invisible Maze</title><script type="text/javascript"src="js/jquery.min.js"></script><script type="text/javascript"src="js/jquery.touchSwipe.min.js"></script><script type="text/javascript"src="js/jquery.cookie.js"></script><script type="text/javascript"src="js/howler.js-master/howler.min.js"></script></script><style>*{margin:0;padding:0;}
html,body{width:100%;height:100%;text-align:center; overflow: hidden;  position: fixed;}#landscapeAlert{font-family:"bpreplay","Helvetica",Arial,sans-serif;text-align:center;margin-top:50px;display:none;}@media screen and(min-width:320px){@media(orientation:portrait){canvas{display:block;}#landscapeAlert{display:none;}}@media(orientation:landscape){canvas{display:none;}#landscapeAlert{display:block;}}}@media(min-width:641px){canvas{display:block;}#landscapeAlert{display:none;}}@font-face{font-family:'bpreplaybold';src:url('fonts/bpreplaybold/bpreplaybold-webfont.eot');src:url('fonts/bpreplaybold/bpreplaybold-webfont.eot?#iefix')format('embedded-opentype'),url('fonts/bpreplaybold/bpreplaybold-webfont.woff')format('woff'),url('fonts/bpreplaybold/bpreplaybold-webfont.ttf')format('truetype'),url('/fonts/bpreplaybold/bpreplaybold-webfont.svg#bpreplaybold')format('svg');font-weight:normal;font-style:normal;}</style></head><body><h1 id="landscapeAlert">Please turn phone vertically to play</h1><script type="text/javascript">var game={mode:'initial_load',paused:false,level:0,which_maze_on_level:0,tries:1,start_level_time:0,time_in_current_try_at_level:0,writelog:true,scoreText:'Go!',colors:{black:'0,0,0',blue:'0,166,255',yellow:'255,247,0',orange:'255,120,0',bluedark:'0,51,153',pink:'255,0,238',purple:'153,0,255',green:'55,255,0',grey:'155,155,155'},colorsNamesArray:['black','blue','yellow','orange','bluedark','pink','green','grey'],backgroundColorString:'rgba(0,0,0,0)',circlesColorString:'rgba(200,200,200,',animation_queue:[],instructions_wall_alpha:1,target_radius:25,target_alpha:1000,keydownStartTime:null,creative_selected:null};game.version=null;game.isBeta=null;var grid={rows:6,cols:4,spacingH:120,spacingV:142,tolerance:10,circles:{alpha:1000,radius:10}};game.log=function(logText){if(game.writelog)console.log(logText);};game.start=function(shouldIgnoreCookie){var queryStringObj=createObjFromQueryString();if(typeof queryStringObj.maze!=='undefined'){queryStringObj.level=parseInt(queryStringObj.level);queryStringObj.maze=parseInt(queryStringObj.maze);console.log(queryStringObj);game.level=queryStringObj.level+1;game.which_maze_on_level=queryStringObj.maze+1;maze=mazeArray[game.level][game.which_maze_on_level];game.maze_set_up();game.level_set_up();game.mode='pre_level';if(typeof queryStringObj.showLevels!=='undefined'){game.mode='showLevels';}}else if((typeof shouldIgnoreCookie==='undefined')&&(typeof game.last_completed_level!=='undefined')){game.welcome_back_screen_setup();}else{game.start_menu_setup();}};game.start_menu_setup=function(){game.level=0;game.which_maze_on_level=0;maze=mazeArray[game.level][game.which_maze_on_level];game.maze_set_up();game.start_menu_animation_step=0;game.level_set_up();if(typeof game.opening_tune_sound=='undefined'){game.opening_tune_sound=new Howl({urls:['sounds/opening_tune_flute_1.mp3','sounds/opening_tune_flute_1.ogg'],loop:true,onload:function(){this.play();this.isPlaying=true;}});}
game.mode='start_menu';};game.welcome_back_screen_setup=function(){var last_level_and_maze=game.return_next_level_and_maze(game.level,game.which_maze_on_level);if(last_level_and_maze!=false){game.level=last_level_and_maze[0];game.which_maze_on_level=last_level_and_maze[1];}
maze=mazeArray[game.level][game.which_maze_on_level];if(typeof maze=='undefined'){maze=mazeArray[0][0];$.removeCookie('invisible_maze');}
game.mode='welcome_back';};game.level_map_screen_setup=function(){game.level=0;game.which_maze_on_level=0;maze=mazeArray[game.level][game.which_maze_on_level];game.maze_set_up();if(typeof game.last_completed_level!='undefined')game.level=game.last_completed_level;else game.level=1;game.mode='level_map';};game.check_maze_integrity=function(){if(maze.v.length!=(maze.h.length+1))game.log('H length is out of synch with V.  h rows should = v rows -1.  h.length='+maze.h.length+'  v.length='+maze.v.length);if(maze.v[0].length!=(maze.h[0].length-1))game.log('H[0] length is out of synch with V.  h[0].length should = v[0]+1'+maze.h[0].length+'  v.length='+maze.v[0].length);var v_col_length=maze.v[0].length;for(a=1;a<maze.v.length;a++){if(maze.v[a].length!=v_col_length)game.log('the maze v walls dont align');}
var h_col_length=maze.h[0].length;for(a=1;a<maze.h.length;a++){if(maze.h[a].length!=h_col_length)game.log('the maze h walls dont align');}};game.level_set_up=function(){if(game.level<=1){game.circlesColorString='rgba(200,200,200,';game.backgroundColorString="rgba(255,255,255,1)";}else{game.circlesColorString='rgba(255,255,255,';game.backgroundColorString="rgba("+game.colors[game.colorsNamesArray[(game.level-1)]]+",.3)";}
game.maze_set_up();game.level_reset();game.mode='pre_level';game.start_level_time=Date.now();};game.level_reset=function(){game.mode='play';game.paused=false;time_in_current_try_at_level=0;game.target_radius=Math.floor(grid.spacingV/4);hero.reset(maze.hero.startLoc);game.scoreText="";game.animation_queue_populate_walls();game.log("..................game reset.  level="+game.level+" maze="+game.which_maze_on_level+" mode="+game.mode+" paused="+game.paused);};game.maze_set_up=function(){game.tries=1;game.walls_hit_queue=[];game.check_maze_integrity();maze.h_walls_count=game.count_walls(maze.h);maze.v_walls_count=game.count_walls(maze.v);maze.v_walls=game.return_array_of_walls_randomized(maze.v);maze.h_walls=game.return_array_of_walls_randomized(maze.h);grid.rows=maze.v.length;grid.cols=maze.v[0].length+1;grid.spacingH=Math.floor(game.canvas.width/grid.cols);grid.spacingV=Math.floor(game.canvas.height/grid.rows);grid.offsetH=Math.floor(grid.spacingH/2);grid.offsetV=Math.floor(grid.spacingV/2);maze.wallCollisionOverlap=Math.floor((grid.spacingV/4)/1.5);grid.tolerance=Math.floor(grid.spacingH/2);hero.reset(maze.hero.startLoc);hero.radius=Math.floor(grid.spacingV/4);maze.target.x=grid.return_nexus_pixels_x(maze.target.pos[0]);maze.target.y=grid.return_nexus_pixels_y(maze.target.pos[1]);game.target_radius=Math.floor(grid.spacingV/4);};game.draw_timer=function(time){game.draw_text(game.time_in_current_try_at_level.toFixed(1),'s','green',maze.target.y+10,(maze.target.x-(game.canvas.width/2)));};game.draw_text=function(string,size,color,y,xOffCenter){var sizes={'xxl':70,'xl':50,'l':35,'m':25,'s':20};game.canvasContext.save();game.canvasContext.font=sizes[size]+"px bpreplaybold";game.canvasContext.textAlign="center";game.canvasContext.textBaseline="center";game.canvasContext.fillStyle="rgb("+game.colors[color]+")";game.canvasContext.fillText(string,(game.canvas.width/2)+xOffCenter,y);game.canvasContext.restore();return y+sizes[size];};game.draw_start_menu=function(){switch(game.start_menu_animation_step)
{case 0:nextLineYpos=game.draw_text("Invisible",'xl','pink',300,0);nextLineYpos=game.draw_text("Maze",'xxl','pink',nextLineYpos+10,0);if(game.time_in_current_try_at_level.toFixed(1)>2)++game.start_menu_animation_step;break;case 1:if(hero.y>grid.spacingV*1-grid.offsetV/2)++game.start_menu_animation_step;else hero.y=hero.y+1;break;case 2:if(hero.y>grid.spacingV*2-grid.offsetV/2)++game.start_menu_animation_step;else hero.y=hero.y+1;break;case 3:break;case 4:game.level_set_up();game.walls_hit_queue.push(['h',[1,0],0,0]);game.mode='start_menu';++game.start_menu_animation_step;break;case 5:if(hero.y>grid.spacingV*2-grid.offsetV){++game.start_menu_animation_step;hero.direction='e';}else hero.y=hero.y+1;break;case 6:if(hero.x>grid.spacingH*2-grid.offsetH){++game.start_menu_animation_step;hero.direction='s';}else hero.x=hero.x+1;break;case 7:if(hero.y>grid.spacingV*3-grid.offsetV){++game.start_menu_animation_step;hero.direction='e';}else hero.y=hero.y+1;break;case 8:if(hero.x>grid.spacingH*3-grid.offsetH){++game.start_menu_animation_step;hero.direction='n';}else hero.x=hero.x+4;break;case 9:if(hero.y<grid.spacingV*2-grid.offsetV){++game.start_menu_animation_step;}else hero.y=hero.y-1;break;case 10:break;}
var animation_steps_text=['',"Meet Mr. Wiggles","He's stuck in a maze","with deadly invisible walls","with deadly invisible walls","with deadly invisible walls","Swipe your finger to steer","Swipe your finger to steer","Big swipes go fast","Big swipes go fast","Help him get out!",];nextLineYpos=game.draw_text(animation_steps_text[game.start_menu_animation_step],'m','blue',game.canvas.height-130,0);if(typeof game.played_start_menu_animation_already!='undefined')nextLineYpos=game.draw_text("Tap to start",'l','pink',game.canvas.height-20,0);};game.draw_welcome_back=function(){game.draw_text("menu",'s','grey',20,(game.canvas.width/2)-30);var nextLineYpos=40;nextLineYpos=game.draw_text('Welcome Back!','l','purple',nextLineYpos+30,0);nextLineYpos=game.draw_text("Level  "+game.level+" Maze "+(game.which_maze_on_level+1),'m','blue',nextLineYpos,0);nextLineYpos=game.draw_text(maze.name,'l','blue',nextLineYpos+30,0);if(maze.note!=undefined)nextLineYpos=game.draw_text(maze.note,'s','blue',nextLineYpos+50,0);nextLineYpos=game.draw_text("Tap to start",'l','pink',game.canvas.height-40,0);};game.draw_pre_level=function(){game.draw_text("menu",'s','grey',20,(game.canvas.width/2)-30);var nextLineYpos=40;nextLineYpos=game.draw_text("Level  "+game.level+" Maze "+(game.which_maze_on_level+1),'s','blue',nextLineYpos,0);nextLineYpos=game.draw_text(maze.name,'l','purple',nextLineYpos+50,0);if(maze.note!=undefined)nextLineYpos=game.draw_text(maze.note,'s','blue',nextLineYpos+50,0);nextLineYpos=game.draw_text("Tap to start",'l','pink',game.canvas.height-50,0);};game.draw_post_level=function(){game.draw_text("menu",'s','grey',20,(game.canvas.width/2)-30);var nextLineYpos=60;nextLineYpos=game.draw_text("Great!",'l','purple',nextLineYpos+30,0);nextLineYpos=game.draw_text('It took you '+game.time_in_current_try_at_level.toFixed(1)+' secs','m','blue',nextLineYpos,0);if(game.tries==1)nextLineYpos=game.draw_text('on your first try!','m','blue',nextLineYpos,0);else nextLineYpos=game.draw_text('over '+game.tries+' tries','m','blue',nextLineYpos,0);nextLineYpos=game.draw_text("Next",'l','pink',game.canvas.height-50,0);game.draw_text("Retry Level",'s','pink',23,-100);};game.draw_level_map=function(){var nextLineYpos=40;if(game.level>1)game.draw_text("< Prev ",'s','pink',nextLineYpos,-100);else game.draw_text("Start Over ",'s','pink',nextLineYpos,-100);if(game.level<mazeArray.length-1)game.draw_text("Next >",'s','pink',nextLineYpos,120);nextLineYpos=game.draw_text("Level  "+(game.level),'m','blue',nextLineYpos,0);nextLineYpos=game.draw_text("Pick a maze",'xl','blue',nextLineYpos+30,0);var row=0;var column=0;if(game.target_radius<=0)game.target_radius=Math.floor(grid.spacingV/4);else game.target_radius-=.25;for(a=0,maze_count=mazeArray[game.level].length;a<maze_count;a++){column=a%grid.cols;if((column==0)&&(a!=0))++row;var pixels_pos=grid.return_nexus_pixels(column+1,row+2);if(typeof mazeArray[game.level][a]['done']=='undefined')game.draw_target(pixels_pos[0],pixels_pos[1],game.colors.green,0);game.draw_text(a+1,'s','green',pixels_pos[1]+10,(pixels_pos[0]-(game.canvas.width/2)));}};grid.return_random_grid_nexus=function(){return[parseInt(Math.random()*(grid.rows)),parseInt(Math.random()*(grid.cols))];};grid.return_nexus_pixels=function(xNodeIn,yNodeIn){return[grid.return_nexus_pixels_x(xNodeIn),grid.return_nexus_pixels_y(yNodeIn)];};grid.return_nexus_pixels_x=function(xNodeIn){return(xNodeIn-1)*grid.spacingH+grid.offsetH;};grid.return_nexus_pixels_y=function(yNodeIn){return(yNodeIn-1)*grid.spacingV+grid.offsetV;};grid.draw_all_circles=function(){for(a=0;a<=grid.rows;a++){for(b=0;b<=grid.cols;b++){grid.draw_circle(grid.spacingH*b,grid.spacingV*a);}}};grid.draw_circle=function(centerX,centerY){alpha=Math.abs(grid.circles.alpha);game.canvasContext.save();game.canvasContext.beginPath();game.canvasContext.arc(centerX,centerY,grid.circles.radius,0,2*Math.PI,false);game.canvasContext.lineWidth=3;game.canvasContext.strokeStyle=game.circlesColorString+(alpha/1000)+')';game.canvasContext.stroke();game.canvasContext.restore();};game.draw_target=function(xIn,yIn,colorIn,definedRadius){if((typeof xIn=='undefined')||(typeof yIn=='undefined')){xIn=maze.target.x;yIn=maze.target.y;}
if(typeof colorIn=='undefined'){colorIn=game.colors.green;}
if(typeof definedRadius=='undefined'){radiusAlterDelta=.25;}else radiusAlterDelta=definedRadius;if(game.target_radius<=0)game.target_radius=Math.floor(grid.spacingV/4);else game.target_radius-=radiusAlterDelta;game.canvasContext.save();game.canvasContext.beginPath();game.canvasContext.arc(xIn,yIn,game.target_radius,0,Math.PI*2,false);game.canvasContext.lineWidth=6;game.canvasContext.strokeStyle='rgba('+colorIn+','+Math.abs(game.target_alpha/1000)+')';game.canvasContext.stroke();game.canvasContext.restore();};game.count_walls=function(array_in){var sum=0;for(var a=0;a<array_in.length;a++){for(var b=0;b<array_in[a].length;b++){sum+=array_in[a][b];}}
return sum;};function shuffleArray(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var temp=array[i];array[i]=array[j];array[j]=temp;}
return array;}
game.return_array_of_walls_randomized=function(array_in){var walls_array=[];for(a=0,array_length=array_in.length;a<array_length;a++){for(var b=0,inner_array_length=array_in[a].length;b<inner_array_length;b++){if(array_in[a][b]!=0)walls_array.push([a,b,array_in[a][b]]);}}
return shuffleArray(walls_array);};game.animation_queue_populate_walls=function(){game.animation_queue=[];$.each(maze.v_walls,function animation_queue_add(index,value){game.animation_queue.push(['v',value,((2000/maze.v_walls_count)*index),-10]);});$.each(maze.h_walls,function animation_queue_add(index,value){game.animation_queue.push(['h',value,((2000/maze.h_walls_count)*index)+((1000/maze.h_walls_count)*.5),-20]);});};game.animation_queue_manager=function(){$.each(game.animation_queue,function animation_queue_update(index){if((game.animation_queue[index][2]<=-1000)||(game.animation_queue[index][2]>=1000)){game.animation_queue[index][2]=.99*game.animation_queue[index][2];game.animation_queue[index][3]=game.animation_queue[index][3]*-1;}
else game.animation_queue[index][2]+=game.animation_queue[index][3];if($(this)[0]=='h')game.draw_wall_horizontal($(this)[1][0],$(this)[1][1],(game.animation_queue[index][2]/1000),game.colors[game.colorsNamesArray[$(this)[1][2]]],$(this)[1][2]);if($(this)[0]=='v')game.draw_wall_vertical($(this)[1][1],$(this)[1][0],(game.animation_queue[index][2]/1000),game.colors[game.colorsNamesArray[$(this)[1][2]]],$(this)[1][2]);});$.each(game.walls_hit_queue,function draw_all_hit_walls(index){if($(this)[0]=='h')game.draw_wall_horizontal($(this)[1][0],$(this)[1][1],1,game.colors[game.colorsNamesArray[$(this)[1][2]]],$(this)[1][2]);if($(this)[0]=='v')game.draw_wall_vertical($(this)[1][1],$(this)[1][0],1,game.colors[game.colorsNamesArray[$(this)[1][2]]],$(this)[1][2]);});};game.draw_all_walls=function(){$.each(maze.v_walls,function draw_all_walls_v(index,value){game.draw_wall_vertical(value[1],value[0],.5,game.colors[game.colorsNamesArray[value[2]]],value[2]);});$.each(maze.h_walls,function draw_all_walls_h(index,value){game.draw_wall_horizontal(value[0],value[1],.5,game.colors[game.colorsNamesArray[value[2]]],value[2]);});};game.draw_wall_vertical=function(row,column,alpha,color,wall_type){game.draw_wall(grid.spacingH+(row*grid.spacingH),(column*grid.spacingV),grid.spacingH+(row*grid.spacingH),(column*grid.spacingV)+grid.spacingV,alpha,color,wall_type);};game.draw_wall_horizontal=function(row,column,alpha,color,wall_type){game.draw_wall((column*grid.spacingH),(grid.spacingV+(row*grid.spacingV)),((column*grid.spacingH)+grid.spacingH),(grid.spacingV+(row*grid.spacingV)),alpha,color,wall_type);};game.draw_wall=function(fromX,fromY,toX,toY,alpha,color,wall_type){game.canvasContext.lineWidth=10;game.canvasContext.lineCap='round';game.canvasContext.beginPath();game.canvasContext.moveTo(fromX,fromY);if(wall_type==1){game.canvasContext.lineTo(toX,toY);color=game.colors['blue'];game.canvasContext.strokeStyle='rgba('+color+','+alpha+')';}else if(wall_type==2){color=game.colors['yellow'];var controlPointX=Math.floor((fromX+toX)/2);var controlPointY=Math.floor((fromY+toY)/2);var wiggleRoom=alpha*20;if(toX==fromX)controlPointX=controlPointX+wiggleRoom;if(toY==fromY)controlPointY=controlPointY+wiggleRoom;if(alpha==1)alpha=0;game.canvasContext.quadraticCurveTo(controlPointX,controlPointY,toX,toY);game.canvasContext.strokeStyle='rgba('+color+','+alpha+')';}else if(wall_type==6){color=game.colors['purple'];var firstWallSectionEndPointX=fromX;var firstWallSectionEndPointY=fromY;if(toX==fromX)firstWallSectionEndPointY=fromY+(.5*toY*alpha);if(toY==fromY)firstWallSectionEndPointX=fromX+(.5*toX*alpha);game.canvasContext.lineTo(firstWallSectionEndPointX,firstWallSectionEndPointY);game.canvasContext.strokeStyle='rgba('+color+','+alpha+')';game.canvasContext.moveTo(toX,toY);var secondWallSectionEndPointX=toX;var secondWallSectionEndPointY=toY;if(toX==fromX)secondWallSectionEndPointY=toY-(.5*(toY-fromY)*alpha);if(toY==fromY)secondWallSectionEndPointX=toX-(.5*(toX-fromX)*alpha);game.canvasContext.lineTo(secondWallSectionEndPointX,secondWallSectionEndPointY);game.canvasContext.strokeStyle='rgba('+color+','+alpha+')';}
game.canvasContext.stroke();};game.stringify_completed_mazes=function(){var stringOfCompletedMazes='';for(a=0,level_count=mazeArray.length;a<level_count;a++){for(b=0,maze_count=mazeArray[a].length;b<maze_count;b++){if(typeof mazeArray[a][b]['done']!='undefined'){stringOfCompletedMazes=stringOfCompletedMazes+','+a+'_'+b;}}}
return stringOfCompletedMazes.substring(1);};game.de_stringify_completed_mazes=function(string_in){var completed_mazes_array=string_in.split(",");for(a=0,count=completed_mazes_array.length;a<count;a++){var temp_array=completed_mazes_array[a].split('_');if(typeof mazeArray[temp_array[0]][temp_array[1]]!='undefined')mazeArray[temp_array[0]][temp_array[1]]['done']=true;}
var last_maze_string=completed_mazes_array[completed_mazes_array.length-1];var last_maze=last_maze_string.split('_');return[last_maze[0],last_maze[1]];};game.return_next_level_and_maze=function(levelIn,mazeIn){if((typeof levelIn=="undefined")||(typeof mazeIn=="undefined")){levelIn=game.level;mazeIn=game.which_maze_on_level;}
if(mazeIn<(mazeArray[levelIn].length-1)){++mazeIn;}else{if((levelIn+1)>=mazeArray.length)return false;else{++levelIn;mazeIn=0;}}
return[levelIn,mazeIn];};game.go_to_next_maze_on_whichever_level=function(){var level_maze=game.return_next_level_and_maze();game.level=level_maze[0];game.which_maze_on_level=level_maze[1];};var hero={min_speed:50,max_speed:200,speed:100,wiggle:4,wiggle_direction:-1,ready:true,currentSlot:1,currentSlotInPixels:0,nextWallCollision:false,alpha:1000,radius:25,isAlive:true};hero.reset=function(startLoc){if(typeof startLoc==='undefined')startLoc=[1,1];hero.x=grid.return_nexus_pixels_x(startLoc[0]);hero.y=grid.return_nexus_pixels_y(startLoc[1]);hero.alpha=1000;hero.radius=Math.floor(grid.spacingV/4);hero.direction=false;hero.nextWallCollision=false;hero.requestedDirectionChange=false;hero.wiggle=0;hero.isAlive=true;};hero.die=function(){if(!hero.isAlive)return;hero.isAlive=false;hero.speed=0;game.mode="deathAnimation";game.play_sound('blast');}
hero.drawHeroLive=function(){hero.drawHero(hero.isAlive);}
hero.drawHeroDead=function(){hero.drawHero(hero.isAlive);}
hero.drawHero=function(aliveness){var hero_direction_angle_lookup={'e':270,'w':90,'s':0,'n':180};if(Math.abs(hero.wiggle)>4)hero.wiggle_direction=hero.wiggle_direction*-1;hero.wiggle+=hero.wiggle_direction;if(!hero.direction){rotation_direction=0+hero.wiggle;}else rotation_direction=hero_direction_angle_lookup[hero.direction]+hero.wiggle;game.canvasContext.save();game.canvasContext.translate(hero.x,hero.y);game.canvasContext.rotate(rotation_direction*Math.PI/180);game.canvasContext.beginPath();game.canvasContext.arc(0,0,hero.radius,0,Math.PI,false);game.canvasContext.lineTo(0,0-hero.radius);game.canvasContext.closePath();if(aliveness===true){game.canvasContext.fillStyle='rgba('+game.colors.green+','+hero.alpha/1000+')';game.canvasContext.fill();game.canvasContext.beginPath();game.canvasContext.arc(0,hero.radius/3,hero.radius/3,90/180,Math.PI,false);game.canvasContext.closePath();game.canvasContext.fillStyle="#FFFFFF";game.canvasContext.fill();game.canvasContext.beginPath();game.canvasContext.arc(-hero.radius/4,-hero.radius/6,hero.radius/6,0,Math.PI*2,false);game.canvasContext.arc(hero.radius/4,-hero.radius/6,hero.radius/6,0,Math.PI*2,false);game.canvasContext.closePath();game.canvasContext.fill();}else{game.canvasContext.strokeStyle='#333333';game.canvasContext.stroke();game.canvasContext.beginPath();game.canvasContext.moveTo(-hero.radius/2,-hero.radius/4);game.canvasContext.lineTo(-hero.radius/4,0);game.canvasContext.moveTo(-hero.radius/4,-hero.radius/4);game.canvasContext.lineTo(-hero.radius/2,0);game.canvasContext.stroke();game.canvasContext.beginPath();game.canvasContext.moveTo(hero.radius/2,-hero.radius/4);game.canvasContext.lineTo(hero.radius/4,0);game.canvasContext.moveTo(hero.radius/4,-hero.radius/4);game.canvasContext.lineTo(hero.radius/2,0);game.canvasContext.stroke();game.canvasContext.rotate(180*Math.PI/180);game.canvasContext.beginPath();game.canvasContext.arc(0,-hero.radius/2,hero.radius/3,0,Math.PI,false);game.canvasContext.stroke();}
game.canvasContext.restore();}
hero.requestDirectionChange=function(direction,swipe_distance){switch(direction)
{case 37:case"left":hero.requestedDirectionChange='w';break;case 38:case"up":hero.requestedDirectionChange='n';break;case 39:case"right":hero.requestedDirectionChange='e';break;case 40:case"down":hero.requestedDirectionChange='s';break;default:}
if(swipe_distance!=null){var new_speed=hero.min_speed+(hero.max_speed*(swipe_distance/game.canvas.width));if(hero.requestedDirectionChange==hero.direction){hero.speed=hero.min_speed+new_speed;}else{hero.speed=new_speed;}}};hero.TryChangeDirection=function(){if((!hero.direction)||(hero.requestedDirectionChange==hero.direction)){hero.updateDirection(false);return;}
if(hero.direction=='n'){if(hero.requestedDirectionChange=='s'){hero.updateDirection(false);return;}
hero.canChangeDirection(hero.y,grid.spacingV,grid.offsetV);}
if(hero.direction=='s'){if(hero.requestedDirectionChange=='n'){hero.updateDirection(false);return;}
hero.canChangeDirection(hero.y,grid.spacingV,grid.offsetV);}
if(hero.direction=='e'){if(hero.requestedDirectionChange=='w'){hero.updateDirection(false);return;}
hero.canChangeDirection(hero.x,grid.spacingH,grid.offsetH);}
if(hero.direction=='w'){if(hero.requestedDirectionChange=='e'){hero.updateDirection(false);return;}
hero.canChangeDirection(hero.x,grid.spacingH,grid.offsetH);}};hero.whichSlotAmIClosestTo=function(){if((hero.direction=='w')||(hero.direction=='e')){slot=(Math.floor(hero.y/grid.spacingV));slotInPixels=(slot*grid.spacingV)+grid.offsetV;}else{slot=(Math.floor(hero.x/grid.spacingH));slotInPixels=(slot*grid.spacingH)+grid.offsetH;}
return[slot,slotInPixels];};hero.canChangeDirection=function(XorYposition,slotSpacing,offsetter){if(hero.requestedDirectionChange===false)return;nextSlot=(Math.floor(XorYposition/slotSpacing));nextSlotInPixels=(nextSlot*slotSpacing)+offsetter;if((XorYposition>=nextSlotInPixels-grid.tolerance)&&(XorYposition<=nextSlotInPixels+grid.tolerance)){hero.updateDirection(nextSlot);}};hero.updateDirection=function(nextSlot){if(!hero.requestedDirectionChange)return;hero.direction=hero.requestedDirectionChange;hero.requestedDirectionChange=false;var temp=hero.whichSlotAmIClosestTo();hero.currentSlot=temp[0];hero.currentSlotInPixels=temp[1];game.play_sound('heroTurn');hero.determineNextWallCollision();};hero.determineNextWallCollision=function(){hero.nextWallCollision=false;if(hero.direction=='s'){if(hero.currentSlot>=grid.cols)return;for(b=0;b<maze.h.length;b++){if(maze.h[b][hero.currentSlot]!=0){if(((b*grid.spacingV)+grid.spacingV)>hero.y){hero.nextWallCollision=['h',[b,hero.currentSlot,maze.h[b][hero.currentSlot]],(b*grid.spacingV+grid.spacingV)-maze.wallCollisionOverlap];return;}}}
return;}
if(hero.direction=='n'){if(hero.currentSlot<0)return;for(b=maze.h.length-1;b>=0;b--){if(maze.h[b][hero.currentSlot]!=0){if((((b+1)*grid.spacingV))<hero.y){hero.nextWallCollision=['h',[b,hero.currentSlot,maze.h[b][hero.currentSlot]],((b+1)*grid.spacingV)+maze.wallCollisionOverlap];return;}}}
return;}
if(hero.direction=='e'){if((hero.currentSlot<0)||(hero.currentSlot>=grid.rows))return;for(b=0;b<maze.v.length;b++){if(maze.v[hero.currentSlot][b]!=0){if(((b*grid.spacingH)+grid.spacingH)>hero.x){hero.nextWallCollision=['v',[hero.currentSlot,b,maze.v[hero.currentSlot][b]],((b*grid.spacingH)+grid.spacingH)-maze.wallCollisionOverlap];return;}}}
return;}
if(hero.direction=='w'){if((hero.currentSlot<0)||(hero.currentSlot>=grid.rows))return;for(b=maze.v.length-1;b>=0;b--){if(maze.v[hero.currentSlot][b]!=0){if(((b*grid.spacingH)+grid.spacingH)<hero.x){hero.nextWallCollision=['v',[hero.currentSlot,b,maze.v[hero.currentSlot][b]],((b*grid.spacingH)+grid.spacingH)+maze.wallCollisionOverlap];return;}}}
return;}};hero.should_add_to_walls_hit_queue=function(){isAlreadyInHitWallsQueue=false;for(var a=0,max=game.walls_hit_queue.length;a<max;a++){if((game.walls_hit_queue[a][0]==hero.nextWallCollision[0])&&(game.walls_hit_queue[a][1][0]==hero.nextWallCollision[1][0])&&(game.walls_hit_queue[a][1][1]==hero.nextWallCollision[1][1])){isAlreadyInHitWallsQueue=true;break;}}
if(isAlreadyInHitWallsQueue===false)game.walls_hit_queue.push(hero.nextWallCollision);}
hero.hit_wall=function(){if(hero.nextWallCollision[1][2]==1){game.mode="deathAnimation";hero.should_add_to_walls_hit_queue();hero.die();}else if(hero.nextWallCollision[1][2]==2){game.play_sound('boing');switch(hero.direction)
{case'e':hero.requestedDirectionChange='w';break;case'w':hero.requestedDirectionChange='e';break;case'n':hero.requestedDirectionChange='s';break;case's':hero.requestedDirectionChange='n';break;}
if(hero.speed<300)hero.speed=hero.speed*1.5;hero.updateDirection(false);}else if(hero.nextWallCollision[1][2]==6){$.each(game.animation_queue,function findNextWallCollisionInAnimation_queue(index,value){if(hero.nextWallCollision[0]!=game.animation_queue[index][0])return;if(hero.nextWallCollision[1][0]!=game.animation_queue[index][1][0])return;if(hero.nextWallCollision[1][1]!=game.animation_queue[index][1][1])return;if(game.animation_queue[index][2]>600){game.mode="deathAnimation";hero.die();}else hero.determineNextWallCollision();});}};hero.hit_target=function(){if(game.mode=='play'){game.play_sound('winner');game.mode='hitTargetAnimation';}else if(game.mode=='start_menu'){game.start_menu_animation_step=10;}
if(game.level==0)return;mazeArray[game.level][game.which_maze_on_level]['done']=true;var time_in_current_try_at_level_in_MS=game.time_in_current_try_at_level*1000;var data_prep={maze:mazeArray[game.level][game.which_maze_on_level].id,time_in_current_try_at_level:time_in_current_try_at_level_in_MS,tries:game.tries};



$.cookie('invisible_maze',game.stringify_completed_mazes(),{expires:365});};var mazeArray=[[{id:0,name:"start_menu_maze",v:[[1,0],[0,1],[0,0],[0,0]],h:[[0,1,1],[1,0,0],[0,0,0]],wallCollisionOverlap:20,target:{pos:[3,2]},hero:{startLoc:[1,1]}}],[{id:1,name:"How to play",note:"A short swipe moves you",v:[[0,0],[2,2],[2,2],[2,2]],h:[[0,2,0],[0,0,0],[0,0,0]],target:{pos:[2,4]},hero:{startLoc:[2,2]}},{id:2,name:"To go faster",note:"Try making a longer swipe",v:[[0,0],[2,2],[2,2],[2,2]],h:[[0,2,0],[0,0,0],[0,0,0]],target:{pos:[2,4]},hero:{startLoc:[2,2]}},{id:3,name:"Try your first turn",note:"A short swipe does it",v:[[0,0],[2,2],[2,0],[0,0]],h:[[0,2,0],[0,0,2],[0,2,2]],target:{pos:[3,3]},hero:{startLoc:[2,2]}},{id:4,name:"Walls are deadly",note:"even when invisible",v:[[1],[0]],h:[[0,0]],target:{pos:[2,1]},hero:{startLoc:[1,1]}},{id:5,name:"The Doors",note:"please stand clear",v:[[1],[6]],h:[[6,6]],target:{pos:[2,1]},hero:{startLoc:[1,1]}}],[{id:6,name:"Juliet's Jumper",note:"Just join Juliet's Jamboree",v:[[1,1],[0,1],[1,0]],h:[[0,0,0],[2,0,0]],target:{pos:[3,1]},hero:{startLoc:[1,1]}},{id:7,name:"Ride the Snake",note:"Just follow your nose",v:[[1,0],[1,1],[1,1],[0,1]],h:[[0,0,0],[6,6,6],[0,0,0]],target:{pos:[3,4]},hero:{startLoc:[1,1]}},{id:8,name:"Johnny Come Lately",note:"",v:[[0,0],[0,1],[1,0],[0,1]],h:[[1,0,1],[0,1,0],[0,0,0]],target:{pos:[3,4]},hero:{startLoc:[1,1]}},{id:9,name:"The Frenemy",note:"",v:[[1,0],[0,0],[0,1],[0,0]],h:[[0,0,0],[1,1,0],[0,1,0]],target:{pos:[2,3]},hero:{startLoc:[1,1]}},{id:10,name:"Bouncy Castle",note:"Yellow walls are different",v:[[2,0],[0,2],[0,2],[0,0]],h:[[0,0,0],[2,2,6],[0,2,0]],target:{pos:[2,3]},hero:{startLoc:[1,1]}},{id:11,name:"MindCraft",note:"",v:[[1,0],[1,1],[1,1],[0,0]],h:[[0,0,0],[0,0,0],[0,1,0]],target:{pos:[2,3]},hero:{startLoc:[1,1]}},{id:12,name:"Bounce Bang",note:"",v:[[0,0],[0,1],[1,1],[1,6]],h:[[1,1,0],[6,0,6],[0,0,6]],target:{pos:[1,4]},hero:{startLoc:[1,1]}},{id:13,name:"Freedom",note:"of Association",v:[[1,0],[0,1],[0,1],[0,0]],h:[[0,1,0],[1,0,0],[0,1,0]],target:{pos:[2,1]},hero:{startLoc:[1,1]}},{id:14,name:"Once",note:"This one goes up to 11",v:[[1,0],[1,0],[1,0],[0,0]],h:[[0,0,1],[0,1,0],[0,0,1]],target:{pos:[3,1]},hero:{startLoc:[1,1]}}],[{id:15,name:"Our Mutual Friend",note:"",v:[[0,0],[1,1],[0,1],[0,0]],h:[[1,1,0],[0,0,0],[1,0,0]],target:{pos:[1,2]},hero:{startLoc:[1,1]}},{id:16,name:"Falstaff's Revenge",note:"",v:[[0,0],[0,1],[0,1],[0,0]],h:[[0,1,0],[1,1,0],[0,1,0]],target:{pos:[2,3]},hero:{startLoc:[2,2]}},{id:17,name:"The Minatour",note:"",v:[[1,0],[0,1],[0,1],[1,0]],h:[[0,0,0],[1,1,0],[0,0,0]],target:{pos:[1,4]},hero:{startLoc:[1,1]}},{id:18,name:"Stair Steps",note:"",v:[[0,0],[1,0],[1,0],[0,0]],h:[[0,0,1],[0,1,1],[0,1,0]],target:{pos:[2,3]},hero:{startLoc:[3,2]}},{id:19,name:"Wake up!",note:"",v:[[0,0],[1,0],[1,0],[0,0]],h:[[0,0,1],[0,1,1],[0,1,0]],target:{pos:[3,2]},hero:{startLoc:[2,3]}}],[{id:20,name:"The danger zone",note:"",v:[[1,0,0],[0,1,0],[0,0,1],[0,0,0]],h:[[0,1,0,1],[1,0,1,0],[0,1,1,0]],target:{pos:[2,1]},hero:{startLoc:[1,1]}},{id:21,name:"Dumb ways to die",note:"So many...",v:[[0,0,0],[0,0,0],[1,0,0],[0,1,0]],h:[[1,1,1,0],[0,1,1,1],[0,0,1,0]],target:{pos:[3,4]},hero:{startLoc:[1,1]}},{id:22,name:"A Simple Plan",note:"This is for real y'all",v:[[1,0,1],[0,1,0],[1,0,0],[0,1,1]],h:[[0,0,0,0],[0,1,1,0],[1,0,0,0]],target:{pos:[1,4]},hero:{startLoc:[1,1]}}],[{id:23,name:"2 men enter",note:"1 man leave",v:[[0,0,0],[1,0,1],[1,1,1],[1,0,1],[0,1,0]],h:[[0,1,1,0],[0,0,0,0],[0,0,1,0],[0,1,0,0]],target:{pos:[3,3]},hero:{startLoc:[1,1]}},{id:24,name:"Platypus",note:"or Echidna?",v:[[0,1,0],[1,0,1],[0,1,1],[1,1,1],[0,1,0]],h:[[0,0,0,0],[1,0,1,0],[0,1,0,0],[0,0,0,0]],target:{pos:[3,3]},hero:{startLoc:[2,3]}},{id:25,name:"vertically challenged",note:"",v:[[1,0,1],[0,1,0],[1,0,1],[0,1,0],[1,0,1]],h:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],target:{pos:[4,4]},hero:{startLoc:[1,1]}},{id:26,name:"Shattered",note:"",v:[[0,0,0],[0,1,0],[1,0,0],[0,0,1],[0,1,0]],h:[[1,0,0,1],[0,0,0,1],[0,0,1,1],[0,1,0,0]],target:{pos:[4,4]},hero:{startLoc:[1,1]}},{id:27,name:"up your alley",note:"",v:[[0,1,0],[0,0,1],[1,0,0],[0,1,0],[1,0,0]],h:[[1,0,0,0],[0,1,1,0],[1,0,0,1],[0,1,1,0]],target:{pos:[1,5]},hero:{startLoc:[1,1]}},{id:28,name:"Bad Mojo",note:"",v:[[0,1,0],[1,0,0],[1,0,0],[1,1,0],[0,1,0]],h:[[0,0,1,0],[0,1,1,1],[0,0,1,0],[0,0,0,1]],target:{pos:[4,5]},hero:{startLoc:[1,1]}}],[{id:29,name:"Give Up",note:"You are already dead",v:[[1,1,1],[0,0,1],[1,1,0],[1,1,1],[1,1,1],[0,1,0]],h:[[0,0,0,1],[0,0,0,0],[1,0,1,0],[0,0,0,0],[0,0,0,0]],target:{pos:[3,4]},hero:{startLoc:[1,1]}},{id:30,name:"Cross Eyes",note:"Left as an exercise for the reader",v:[[1,0,1],[0,1,1],[1,1,0],[1,1,1],[1,0,1],[0,1,0]],h:[[0,0,0,1],[0,0,0,0],[1,0,1,0],[0,1,0,0],[0,0,0,0]],target:{pos:[1,4]},hero:{startLoc:[1,1]}}]];function CanvasClickHandlerTouchEnd(X,Y){if(game.mode=='play'){if((Y<40)&&(X>(game.canvas.width-50))){if((typeof game.touchStart!=='undefined')&&(typeof game.touchStart.pageX!=='undefined')&&(typeof game.touchStart.pageY!=='undefined')){if((Math.abs(X-game.touchStart.pageX)<10)&&(Math.abs(Y-game.touchStart.pageY)<10)){game.level_map_screen_setup();}}}}
game.touchStart=undefined;}
function CanvasClickHandler(X,Y){if(game.mode=='start_menu'){if(typeof game.played_start_menu_animation_already=='undefined')return;game.level=1;game.which_maze_on_level=0;maze=mazeArray[game.level][game.which_maze_on_level];game.maze_set_up();game.mode='pre_level';game.opening_tune_sound.fadeOut(0.0,1000);game.opening_tune_sound.isPlaying=false;}
if(game.mode=='pre_level'){if((Y<40)&&(X>(game.canvas.width/2)-30)){game.level_map_screen_setup();return;}
game.level_set_up();game.mode='play';return;}
if(game.mode=='welcome_back'){if(Y>(game.canvas.height-100)){game.level_set_up();game.mode='play';return;}
if(typeof game.last_completed_level!='undefined'){game.level=game.last_completed_level;}
game.level_map_screen_setup();return;}
if(game.mode=='level_map'){if(Y<100){if(X>game.canvas.width/2){if(game.level<mazeArray.length-1)game.level++;}else{if(game.level>1)game.level--;else{$.removeCookie('invisible_maze');location.reload();return;}}
return;}
var clicked_on_column=Math.floor(X/grid.spacingH);var clicked_on_row=Math.floor(Y/grid.spacingV)-1;var which_level=(clicked_on_row*grid.cols)+clicked_on_column;game.which_maze_on_level=which_level;if((clicked_on_column<0)||(clicked_on_row<0)||(which_level>mazeArray[game.level].length))return;maze=mazeArray[game.level][game.which_maze_on_level];game.maze_set_up();game.mode='pre_level';return;}
if(game.mode=='post_level'){if(Y<50){if(X>(game.canvas.width/2)-30){game.level_map_screen_setup();return;}else{game.level_set_up();game.mode='play';return;}}
if((game.which_maze_on_level+1)<mazeArray[game.level].length){++game.which_maze_on_level;}else{++game.level;game.which_maze_on_level=0;}
if(game.level>=mazeArray.length){game.level=0;game.which_maze_on_level=0;game.mode='outOfLevels';return;}
maze=mazeArray[game.level][game.which_maze_on_level];game.mode='pre_level';return;}
if(game.mode=='outOfLevels'){$.removeCookie('invisible_maze');location.reload();return;}
if(game.mode=='showLevels'){game.go_to_next_maze_on_whichever_level();maze=mazeArray[game.level][game.which_maze_on_level];hero.reset(maze.hero.startLoc);game.log('level '+game.level+'maze name '+maze.name);game.maze_set_up();return;}}
function keyboardEventHandler(e){if(game.keydownStartTime==null){game.keydownStartTime=Date.now();}
if(game.mode=='play'){hero.requestDirectionChange(e.keyCode);}
else if((game.mode=='pre_level')||(game.mode=='post_level')||(game.mode=='start_menu'))CanvasClickHandler(100,100);}
game.createCanvas=function(){var myLocalCookie=$.cookie('invisible_maze');if((typeof myLocalCookie!=='undefined')&&(myLocalCookie.indexOf("_")>=0)){var last_played_maze_array=game.de_stringify_completed_mazes(myLocalCookie);last_played_maze_array[0]=parseInt(last_played_maze_array[0]);last_played_maze_array[1]=parseInt(last_played_maze_array[1]);game.level=last_played_maze_array[0];game.which_maze_on_level=last_played_maze_array[1]
game.last_completed_level=game.level;game.last_completed_maze=game.which_maze_on_level;console.log("game.version:"+game.version+" game.level:"+game.level+" game.which_maze_on_level:"+game.which_maze_on_level+" myLocalCookie:"+myLocalCookie);}
game.canvas=document.createElement("canvas");game.canvas.setAttribute("id","da_canvas");game.canvasContext=game.canvas.getContext("2d");game.canvas.width=360;game.canvas.height=568;
var app=document.URL.indexOf('http://')===-1&&document.URL.indexOf('https://')===-1;






if(app){game.canvas.width=window.innerWidth;game.canvas.height=screen.height;}
else{if(window.innerWidth<800){game.canvas.width=window.innerWidth;
	if('standalone'in navigator&&!navigator.standalone&&(/iphone|ipod|ipad/gi).test(navigator.platform)&&(/Safari/i).test(navigator.appVersion)){game.canvas.height=screen.height-110;}
	else{game.canvas.height=screen.height-18;
		if(window.innerHeight<screen.height)game.canvas.height=window.innerHeight;}}}
		game.canvas.height=window.innerHeight;  //override to prevent scrolling

if(window.navigator.standalone){
canvas.height=screen.height-110;
};  // iOS web app 



document.body.appendChild(game.canvas);$("#da_canvas").html('Your browser does not have the functionality to play this game.<br>You can <a href="https://support.google.com/chrome/answer/95346?hl=en">download a free modern browser</a>.</canvas>');$("#da_canvas").focus();$(function swipeInputListener(){$("#da_canvas").swipe({swipe:function(event,direction,distance,duration,fingerCount){if(game.mode=='play'){hero.requestDirectionChange(direction,distance);}
game.sound_effects.play('heroTurn');},});});$(window).blur(function onWindowBlur(){if(game.mode=='play')game.paused=true;game.keydownStartTime=null;});$(window).focus(function onWindowFocus(){game.paused=false;if(game.mode=='play')game.level_reset();game.keydownStartTime=null;});document.addEventListener('click',function onClick(e){CanvasClickHandler(e.clientX,e.clientY);},false);document.addEventListener('touchstart',function onTouchStart(touch){CanvasClickHandler(touch.pageX,touch.pageY);game.touchStart=touch;},false);document.addEventListener('touchend',function onTouchEnd(touch){CanvasClickHandlerTouchEnd(touch.changedTouches[0].pageX,touch.changedTouches[0].pageY);},false);addEventListener("keydown",function onKeydown(e){keyboardEventHandler(e);},false);addEventListener("keyup",function onKeyUp(e){game.keydownStartTime=null;},false);};game.sound_effects=new Howl({urls:['sounds/all.mp3','sounds/all.ogg'],sprite:{blast:[0,1500],boing:[1500,2000],heroTurn:[3500,400],winner:[4000,2500]}});game.play_sound=function(sound_name){var x=game.sound_effects.play(sound_name);};function createObjFromQueryString(){var result={},keyValuePairs=location.search.slice(1).split('&');keyValuePairs.forEach(function splitKeyValuePair(keyValuePair){keyValuePair=keyValuePair.split('=');result[keyValuePair[0]]=keyValuePair[1]||'';});return result;}
game.then=Date.now();window.requestAnimFrame=function(){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame);}();game.mainGameloop=function(){if(game.paused==false){var now=Date.now();var delta=now-game.then;game.updateGameElements(delta/1000);game.renderScreen();game.then=now;}
requestAnimFrame(game.mainGameloop);}
game.updateGameElements=function(modifier){if(game.mode=='initial_load'){game.start_game();}
if((game.mode=='play')||(game.mode=='start_menu')){game.time_in_current_try_at_level=((Date.now()-game.start_level_time)/1000);if(hero.requestedDirectionChange){hero.TryChangeDirection();}
if((game.mode!='start_menu')&&(hero.direction)){switch(hero.direction)
{case'n':hero.y-=Math.floor(hero.speed*modifier);break;case'e':hero.x+=Math.floor(hero.speed*modifier);break;case's':hero.y+=Math.floor(hero.speed*modifier);break;case'w':hero.x-=Math.floor(hero.speed*modifier);break;}
if((hero.direction=='n')||(hero.direction=='s')){hero.x=((3*hero.x)+hero.currentSlotInPixels)/4;}
if((hero.direction=='e')||(hero.direction=='w')){hero.y=((3*hero.y)+hero.currentSlotInPixels)/4;}}
if(hero.nextWallCollision){if(((hero.direction=='s')&&(hero.y>hero.nextWallCollision[2]))||((hero.direction=='n')&&(hero.y<hero.nextWallCollision[2]))||((hero.direction=='w')&&(hero.x<hero.nextWallCollision[2]))||((hero.direction=='e')&&(hero.x>hero.nextWallCollision[2])))
{hero.hit_wall();}}
if(hero.x>=(game.canvas.width+32)||hero.x<=(-20)||hero.y>=(game.canvas.height+10)||hero.y<=(-20)){hero.die();}
if(hero.x<=(maze.target.x+16)&&maze.target.x<=(hero.x+16)&&hero.y<=(maze.target.y+16)&&maze.target.y<=(hero.y+16)){hero.hit_target();}
if(game.keydownStartTime!=null){var now=Date.now();hero.speed=hero.min_speed+((now-game.keydownStartTime));}}
if((game.mode=='deathAnimation')||((game.mode=='start_menu')&&(game.start_menu_animation_step==3))){if(hero.alpha<=0){if(game.mode=='deathAnimation'){game.mode='play';++game.tries;game.level_reset();}else{++game.start_menu_animation_step;}}else{hero.isAlive=false;hero.alpha-=20;hero.radius+=5;hero.wiggle+=5;}}
if((game.mode=='hitTargetAnimation')||((game.mode=='start_menu')&&(game.start_menu_animation_step==10))){if(hero.radius<=0){if(game.start_menu_animation_step==10){game.level_set_up();game.start_menu_animation_step=0;game.mode='start_menu';game.time_in_current_try_at_level=0;game.played_start_menu_animation_already=true;}else{game.mode='post_level';}}else{hero.alpha-=2;hero.radius-=1;hero.wiggle+=5;hero.x=((3*hero.x)+((maze.target.pos[0]*grid.spacingH)-grid.offsetH))/4;hero.y=((3*hero.y)+((maze.target.pos[1]*grid.spacingV)-grid.offsetV))/4;}}};game.renderScreen=function(){game.canvasContext.save();game.canvasContext.setTransform(1,0,0,1,0,0);game.canvasContext.clearRect(0,0,game.canvasContext.canvas.width,game.canvasContext.canvas.height);if(game.level>1){game.canvasContext.fillStyle=game.backgroundColorString;game.canvasContext.fillRect(0,0,game.canvasContext.canvas.width,game.canvasContext.canvas.height);}
game.canvasContext.restore();if(grid.circles.alpha<=-1000)grid.circles.alpha=1000
else grid.circles.alpha-=2;grid.draw_all_circles();if(game.mode=='start_menu'){game.animation_queue_manager();game.draw_start_menu();if((game.start_menu_animation_step==3))hero.drawHeroDead();else if(game.start_menu_animation_step>0){hero.drawHeroLive();game.draw_target();}}
if(game.mode=='pre_level'){game.draw_pre_level();}
if(game.mode=='post_level'){game.draw_post_level();}
if(game.mode=='outOfLevels'){nextLineYpos=game.draw_text("You Finished!",'l','purple',270,0);nextLineYpos=game.draw_text("More levels coming",'m','purple',nextLineYpos+10,0);nextLineYpos=game.draw_text("click to start over",'l','purple',nextLineYpos+10,0);nextLineYpos=game.draw_text("email stephen@turbek.com",'m','blue',nextLineYpos+100,0);nextLineYpos=game.draw_text("with any comments!",'m','blue',nextLineYpos+10,0);}
if(game.mode=='showLevels'){game.draw_target(maze.target.x,maze.target.y);hero.drawHeroLive();game.draw_all_walls();nextLineYpos=game.draw_text("Level  "+(game.level+1),'m','blue',40,0);nextLineYpos=game.draw_text("Maze #  "+(game.level-1),'m','blue',nextLineYpos,0);nextLineYpos=game.draw_text(maze.name,'l','purple',nextLineYpos+30,0);if(maze.note!=undefined)nextLineYpos=game.draw_text(maze.note,'s','blue',nextLineYpos+50,0);}
if(game.mode=='welcome_back'){game.draw_welcome_back();}
if(game.mode=='level_map'){game.draw_level_map();}
if(game.mode=='play'){game.draw_text("menu",'s','grey',20,(game.canvas.width/2)-30);game.draw_timer();game.draw_target(maze.target.x,maze.target.y);game.animation_queue_manager();hero.drawHeroLive();game.draw_target();}
if(game.mode=='hitTargetAnimation'){game.draw_target(maze.target.x,maze.target.y);game.animation_queue_manager();hero.drawHeroLive();}
if(game.mode=='deathAnimation'){game.draw_target(maze.target.x,maze.target.y);game.animation_queue_manager();hero.drawHeroDead();}};$(document).ready(function ready(){game.createCanvas();game.start();game.mainGameloop();});</script></body></html>