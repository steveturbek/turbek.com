<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
  <title>stephen turbek: Automatically Create Table of Contents in Visio</title>

</head>
<body>


<!-- Begin wrapper -->
<div id="wrapper">

<a href="/" id="home-link">
stephen.turbek.com
</a>


<!-- Begin content -->
<div id="content">
<!-- Begin main column -->
<div id="main">

<div class="post"><a name="5313708275876998295"></a>
  
<h1 class="post-title">
Automatically Create Table of Contents in Visio
</h1>




<div style="clear:both;"><h1> NOTE: this is way out of date...</h1></div>



<span style="font-family:arial;">I use Visio to create wireframe documents, and </span><span style=";font-family:arial;font-size:100%;"  >as updating Tables of Contents in Visio is very dull, </span><span style=";font-family:Arial;font-size:100%;"  >I wrote a macro (a small program) that automatically generates a Table of Contents list for a Visio document. </span><span style="font-family:arial;">It is stored in a Stencil.</span><span style="font-size:100%;"><br /><span style="font-family:arial;"><br />The Table of Contents format is:<br />1    First Page<br />2    Another Page<br />3    Etc Page<br /><br />(Where the page title comes from the page title seen in the tabs at the bottom of the page.)<br /><br /><span style="font-weight: bold;">How to use:</span></span><o:p style="font-family: arial; font-weight: bold;"></o:p></span>  <p  style="font-weight: bold;font-family:arial;" class="MsoNormal"><span style="font-size:100%;"><o:p> </o:p></span></p>    <p  style="font-weight: bold;font-family:arial;" class="MsoNormal"><span style="font-size:100%;"><o:p> </o:p></span></p>  <ul><li><!--[if !supportLists]--><span style="font-size:100%;"><span style="font-weight: bold;font-family:arial;" ></span><span style="font-family:arial;">Download </span></span><span style="font-size:100%;"><a href="Table_of_contents_creator_macro.zip">Table_of_contents_creator_macro.zip</a> </span><span style="font-size:100%;"><span style="font-family:arial;">, unzip and save t</span></span><span style=";font-family:arial;font-size:100%;"  >o your My Documents > My Shapes folder<o:p></o:p></span></li><li><!--[if !supportLists]--><!--[endif]--><span style="font-size:100%;"><span style="font-family:arial;">Open Visio</span> <o:p></o:p></span></li><li><!--[if !supportLists]--><span style="font-size:100%;"><span style=""></span></span><!--[endif]--><span style=";font-family:arial;font-size:100%;"  >Go to Tools > Macros > Security</span></li></ul>        <p class="MsoNormal" face="courier new" style="margin-left: 0.25in; text-indent: -0.15in;"></p>  <p class="MsoNormal"  style="font-family:courier new;"><span style="font-size:100%;"><o:p> </o:p></span></p>  <p class="MsoNormal"  style="margin-left: 0.1in;font-family:courier new;"><span style="font-size:100%;"><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600" spt="75" preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">  <v:stroke joinstyle="miter">  <v:formulas>   <v:f eqn="if lineDrawn pixelLineWidth 0">   <v:f eqn="sum @0 1 0">   <v:f eqn="sum 0 0 @1">   <v:f eqn="prod @2 1 2">   <v:f eqn="prod @3 21600 pixelWidth">   <v:f eqn="prod @3 21600 pixelHeight">   <v:f eqn="sum @0 0 1">   <v:f eqn="prod @6 1 2">   <v:f eqn="prod @7 21600 pixelWidth">   <v:f eqn="sum @8 21600 0">   <v:f eqn="prod @7 21600 pixelHeight">   <v:f eqn="sum @10 21600 0">  </v:formulas>  <v:path extrusionok="f" gradientshapeok="t" connecttype="rect">  <o:lock ext="edit" aspectratio="t"> </v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style="'width:471.75pt;">  <v:imagedata src="file:///C:\DOCUME~1\turbek\LOCALS~1\Temp\msohtml1\01\clip_image001.png" title=""> </v:shape><![endif]--><!--[if !vml]--><br /><!--[endif]--><o:p></o:p></span></p>  <p class="MsoNormal"  style="font-family:courier new;"><span style="font-size:100%;"><o:p> </o:p></span></p>  <p class="MsoNormal"  style="font-family:courier new;"><span style="font-size:100%;"><o:p> </o:p></span></p>  <ul><li><!--[if !supportLists]--><span style="font-size:100%;">Set Security to Medium (to allow Visio to run Macros)<o:p></o:p></span></li></ul>  <p class="MsoNormal"  style="margin-left: 0.1in;font-family:courier new;"><br /><span style="font-size:100%;"><!--[if gte vml 1]><v:shape id="_x0000_i1026" type="#_x0000_t75" style="'width:283.5pt;height:259.5pt'">  <v:imagedata src="file:///C:\DOCUME~1\turbek\LOCALS~1\Temp\msohtml1\01\clip_image003.png" title=""> </v:shape><![endif]--><!--[if !vml]--></span></p>
<p class="MsoNormal" style="margin-left: 0.1in; font-family: courier new;"><br /></p><p class="MsoNormal"  style="margin-left: 0.1in;font-family:courier new;"><br /><span style="font-size:100%;"><!--[endif]--><o:p></o:p></span></p>  <p class="MsoNormal"  style="font-family:courier new;"><span style="font-size:100%;"><o:p> </o:p></span></p>  <p class="MsoNormal"  style="font-family:courier new;"><span style="font-size:100%;"><o:p> </o:p></span></p>  <p class="MsoNormal"  style="font-family:courier new;"><span style="font-size:100%;"><o:p> </o:p></span></p>  <ul><li  style="font-family:arial;"><!--[if !supportLists]--><span style="font-size:100%;">Close Visio <o:p></o:p></span></li><li  style="font-family:arial;"><span style="font-size:100%;">Open a Visio Document<o:p></o:p></span></li><li  style="font-family:arial;"><!--[if !supportLists]--><!--[endif]--><span style="font-size:100%;">Select a text box that you want to put the table of contents in<o:p></o:p></span></li><li  style="font-family:arial;"><!--[if !supportLists]--><!--[endif]--><span style="font-size:100%;">Open the Table_of_contents_creator_macro.vss stencil</span></li><li  style="font-family:arial;"><span style="font-size:100%;">Choose to enable macros</span></li><li  style="font-family:arial;"><span style="font-size:100%;">Select the text box you want the Table of Contents to appear in (or it will create a new box)<br /></span></li><li><!--[if !supportLists]--><!--[endif]--><span style="font-size:100%;"><span style="font-family:arial;">Select Tools > Macros > Table_of_contents_creator_macro > Module1 > Table_of_contents_creator</span></span>

</li><li><!--[if !supportLists]--><!--[endif]--><span style="font-size:100%;"><span style="font-family:arial;">That's it!</span><o:p></o:p></span></li></ul>                          <p class="MsoNormal"  style="font-family:courier new;"><span style="font-size:100%;"><o:p> </o:p></span></p>  <p class="MsoNormal"  style="font-family:courier new;"><span style="font-size:100%;"><!--[if gte vml 1]><v:shape id="_x0000_i1027" type="#_x0000_t75" style="'width:678.75pt;height:333.75pt'">  <v:imagedata src="file:///C:\DOCUME~1\turbek\LOCALS~1\Temp\msohtml1\01\clip_image005.png" title=""> </v:shape><![endif]--><!--[if !vml]--><br /><!--[endif]--><o:p></o:p></span></p>  <p class="MsoNormal"  style="font-family:courier new;"><span style="font-size:100%;"><o:p> </o:p></span></p><span style=";font-family:courier new;font-size:100%;"  > <span style="font-family:arial;">Here is the code itself (you would write this in the visual basic editor in Microsoft Visio)</span><br /><span style="font-size:85%;"><br /></span><span style="font-size:85%;">Sub table_of_contents_creator()<br />'this macro creates a table of contents in a visio document by<br />'going through the pages in the document and adds the page number and page title<br /><br />'by stephen turbek s@stephenturbek.com<br />'written for use in microsoft visio 2003 SP1<br /><br />'adapted from http://www.greenonions.com/tocscript<br />'I added allowing user to select a text box and replace the contents, rather than build lots of little boxes<br />'this way you can style the text easily, and simply replace the contents when you update the doc<br />'note: this is my first VB script<br /><br /><br />' define a shape to use for the Table of Contents (TOC)<br />Dim TOCEntry As Visio.Shape<br /><br /><br />'get selection<br />Dim selectedShapes As Selection<br />Set selectedShapes = ActiveWindow.Selection<br /><br /><br /><br />'is any shape selected to put the ToC in?<br />If selectedShapes.Count > 0 Then<br />'take the selected shape to put the table of contents in<br />Set TOCEntry = ActiveWindow.Selection.Item(1)<br />Else<br />'nothing is selected, create a shape<br />Set TOCEntry = ActiveDocument.Pages(1).DrawRectangle(1, 1, 7.5, 10)<br /><br />TOCEntry.Cells("VerticalAlign").Formula = "0"  'make text box top vertically aligned<br />TOCEntry.Cells("Para.HorzAlign").Formula = visHorzLeft 'make text box left aligned<br /><br /><br />End If<br /><br /><br /><br />'clear out the shape's text<br />TOCEntry.Text = ""<br /><br />'a variable to hold the page array<br />Dim PageToIndex As Visio.Page<br /><br /><br />' loop through all the pages<br />For Each PageToIndex In Application.ActiveDocument.Pages<br /><br />'exit when it hits the first background page (don't want those in the ToC)<br />If PageToIndex.Background Then Exit For<br /><br />'append the page number, a tab, the page name, and a return to the ToC text shape<br />TOCEntry.Text = TOCEntry.Text + CStr(PageToIndex.Index) + vbTab + PageToIndex.Name + vbNewLine<br /><br />Next<br /><br /><br />End Sub</span></span><div style="clear:both; padding-bottom:0.25em"></div>
</div>
<!-- End .post -->
  
  
    
<p id="copyright">copyright &copy; Stephen Turbek</p>



</div>


<!-- End wrapper -->
</div>



</body>
</html>